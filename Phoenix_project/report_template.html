<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phoenix Project: After-Action Report</title>
<style>
/* Basic styling for the report page */
body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
margin: 0;
padding: 0;
background-color: #f4f7f6;
color: #333;
}
.container {
max-width: 960px;
margin: 20px auto;
padding: 20px;
background-color: #fff;
border-radius: 8px;
box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}
h1, h2 {
color: #2c3e50;
border-bottom: 2px solid #e0e0e0;
padding-bottom: 10px;
}
h1 {
text-align: center;
}
.summary {
background-color: #ecf0f1;
padding: 20px;
border-radius: 5px;
margin-bottom: 20px;
text-align: center;
}
.summary h2 {
border: none;
margin: 0;
padding: 0;
}
.summary p {
font-size: 2.5em;
font-weight: bold;
color: #2980b9;
margin: 10px 0 0 0;
}
.metrics-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px;
}
.metric {
background-color: #fdfdfd;
padding: 15px;
border: 1px solid #e0e0e0;
border-radius: 5px;
}
.metric-title {
font-weight: bold;
color: #7f8c8d;
}
.metric-value {
font-size: 1.5em;
color: #34495e;
margin-top: 5px;
}
img {
max-width: 100%;
height: auto;
margin-top: 20px;
border-radius: 5px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.footer {
text-align: center;
margin-top: 20px;
font-size: 0.9em;
color: #95a5a6;
}
/* Styles for the Marshal's debriefing section */
.marshal-report {
background-color: #eaf2f8;
border-left: 5px solid #3498db;
padding: 20px;
margin-bottom: 30px;
font-style: italic;
color: #2c3e50;
}
.marshal-report h2 {
border: none;
margin-top: 0;
}
.marshal-report p {
white-space: pre-wrap; /* Preserves line breaks */
}
</style>
</head>
<body>
<div class="container">
<h1>Phoenix Project: After-Action Report</h1>

<!-- Marshal's Debriefing Section -->

<div class="marshal-report">
<h2>Marshal's After-Action Debriefing</h2>
<p>{{ ai_summary_report }}</p>
</div>

<!-- Summary of Final Portfolio Value -->

<div class="summary">
<h2>Final Portfolio Value</h2>
<p>${{ "%.2f"|format(final_value) }}</p>
</div>

<!-- Performance Metrics Section -->

<h2>Performance Metrics</h2>
<div class="metrics-grid">
<div class="metric">
<div class="metric-title">Total Return</div>
<div class="metric-value">{{ "%.2f"|format(total_return * 100) }}%</div>
</div>
<div class="metric">
<div class="metric-title">Sharpe Ratio</div>
<div class="metric-value">{{ "%.3f"|format(sharpe_ratio) if sharpe_ratio is not none else 'N/A' }}</div>
</div>
<div class="metric">
<div class="metric-title">Max Drawdown</div>
<div class="metric-value">{{ "%.2f"|format(max_drawdown) }}%</div>
</div>
</div>

<!-- Trade Statistics Section -->

<h2>Trade Statistics</h2>
<div class="metrics-grid">
<div class="metric">
<div class="metric-title">Total Trades</div>
<div class="metric-value">{{ total_trades }}</div>
</div>
<div class="metric">
<div class="metric-title">Win Rate</div>
<div class="metric-value">{{ "%.2f"|format(win_rate * 100) }}%</div>
</div>
<div class="metric">
<div class="metric-title">Winning / Losing Trades</div>
<div class="metric-value">{{ winning_trades }} / {{ losing_trades }}</div>
</div>
</div>

<!-- Equity Curve and Drawdown Chart -->

{% if plot_filename %}

<h2>Equity Curve & Drawdown</h2>
<img src="{{ plot_filename }}" alt="Backtest Plot">
{% endif %}

{% if audit_files %}

<h2>AI Audit Trail</h2>
<div class="metric">
<div class="metric-title">The following AI interactions influenced this report:</div>
<ul>
{% for file in audit_files %}
<li>{{ file }}</li>
{% endfor %}
</ul>
</div>
{% endif %}

<!-- Footer -->

<div class="footer">
Report generated on {{ report_date }}.
</div>

</div>
</body>
</html>
